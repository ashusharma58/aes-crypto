'use strict'

import { AesUtils, Aes } from '../src'

const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjRkNTExMGFkLTU0YjgtNDkyOS05YjYwLTRiYzkxNDA0ZDZlZiIsImlhdCI6MTU4OTU1MjI5NjEzN30.6_-6KOGpxUFDGjEx0rFvkd90oB47NFrH0qdkbraBT00'
const bodyString = '{"lat": "19.075983","lon": "72.877655"}'
const payload = '1a29a59a28c805e7739cc97352855b00.02dbd58e0a696d4348adc347f53c66a8.bf41e464dac0840f550d0cd3b94a7cdcd27fbfae2440a342c550ac7ccf3c66425200941a3f405b72ab4d8c53f09a19048d859ac8a7fd199e7d036da4dae940e41d582caf843bb29d6963012981002d5e009696b8baeaeace6847408d8ea6073bda0673759d80f950a2254a0aba63df0167938b9b1408400b69f53b8fddb4616b8d7c7357a262619ffd31b602e8889401bba6ae1a95843d7a2cc35ab7c0bec0c1f642f80ac9406c5cde9a5837676aff42b602695b4d5150af0f166a0a174ad4b6f15a0216df46e4a99ae49a7ed2e4f44be0c1053b7829feda61c18b1327a7dce918256fb76f0f3841bb502f92c51dd9b55634235b1b9009d62a89331036077439881fae05a276c7b4d9bf6d52ec854b68f5fc5053915de86f52f54a6d2b3c82c09677b8f68666c44d27067f4bc562fea917daaaef188ae852207b29c3e4b50c04119f2e8cfce95c954dcf04f1ae8ce5e38cb31a4a332ace91867a52282ab0e68569a193190bf43dad0d832a117cff621eec4f579d7eba05d796142bd1f5166ad402e92a469cf8b496c33ee58d6a07cf00f283633290112fdf668a27187e4d72cbd31efee00440baf8ceeae3449edcca6f0d6e13c4dc601451ac2620867afc6c0ab97b1468ec91fe6e9f6fe95f454cb54bf4c8df2859285c18e1fc6cf0c775ab3a5b707cb013f1773e366f01318f91a2a9a85c50ffaf0de46ba1e89b9d3b50789651bb2dc9f4706efa2a4abe1475ef2748876580dfc5f4403c2e61f652f39ce54a848ea24b368e1e02a52af8603fdf518442ec13062b74e21a17dc8514ce8ecc5c8a475d60ac4d2c7a3b3b442709f73118bbb2ec54063dce394b0789a4421103b734268fde7a778480dd76cded34687766712083ec3d6f621665fb882760670df59c3041d20e7d10f66d120da9ed523eb0c71f5f7a6a8430168618fdec3a07e914e157211ed61b3c2bc046dc891d45a6b6739ad0b47f0d71c27487b89bd21f3c8ae055c1ae765611250459ecbfd8fa667dc5edd38c3bfef5e9bdf9716f1ced7e35de2d70c884041ff2bcc5def24777f839dc5c601993b9400a99b492c0c590e74d0d0dd84700639739c213afcb8d8b79b6158030074b23b63bc1a4eb3de4ce368e52461a31cf463ad3cdfe8d3171087bed5d667b510fe6bf653642dc54'
const encryptionKey = AesUtils.extractKeyFromToken(token)
const encryptParams = { key: encryptionKey, data: bodyString, payload }
const encryptedDataObj = Aes.decrypt('aes-256-gcm', encryptParams)
console.log('encryptedDataObj:', encryptedDataObj);
